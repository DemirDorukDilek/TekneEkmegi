{% extends "restoranBase.html" %}

{% block title %}SipariÅŸlerim Â· Tekne EkmeÄŸi{% endblock %}

{% block content %}
<div class="card restoran-home-card">
    <h1>Gelen SipariÅŸler</h1>
    <p class="subtitle">
        RestoranÄ±nÄ±za gelen aktif sipariÅŸleri buradan takip edebilirsiniz.
    </p>

    <div class="restoran-actions-row">
        <a href="/RestoranHomePage" class="btn btn-secondary">â† Ana Sayfa</a>
    </div>

    <h2 class="section-title">Aktif SipariÅŸler</h2>

    {% if siparisler and siparisler|length > 0 %}
    <div class="siparis-list">
        {% for item in siparisler %}
        {% set siparis = item.siparis %}
        {% set detaylar = item.detaylar %}
        <div class="siparis-card">
            <div class="siparis-header">
                <div>
                    <h3 class="siparis-no">SipariÅŸ #{{ siparis[0] }}</h3>
                    <span class="siparis-durum siparis-durum-{{ siparis[1]|lower }}">
                        {% if siparis[1] == 'Get' %}Bekliyor
                        {% elif siparis[1] == 'Cook' %}HazÄ±rlanÄ±yor
                        {% elif siparis[1] == 'OnWay' %}Yolda
                        {% else %}{{ siparis[1] }}
                        {% endif %}
                    </span>
                </div>
            </div>

            <div class="siparis-info">
                <div class="info-section">
                    <h4>ğŸ‘¤ MÃ¼ÅŸteri Bilgileri</h4>
                    <p><strong>Ad Soyad:</strong> {{ siparis[3] }} {{ siparis[4] }}</p>
                    <p><strong>Telefon:</strong> {{ siparis[5] }}</p>
                </div>

                <div class="info-section">
                    <h4>ğŸ“ Teslimat Adresi</h4>
                    <p>{{ siparis[11] }} Mah., {{ siparis[12] }} Cad., No: {{ siparis[13] }}, Daire: {{ siparis[14] }}
                    </p>
                    <p>{{ siparis[10] }}, {{ siparis[9] }}</p>
                </div>

                {% if siparis[6] %}
                <div class="info-section">
                    <h4>ğŸï¸ Kurye Bilgileri</h4>
                    <p><strong>Ad Soyad:</strong> {{ siparis[6] }} {{ siparis[7] }}</p>
                    <p><strong>Telefon:</strong> {{ siparis[8] }}</p>
                </div>
                {% else %}
                <div class="info-section kurye-bekleniyor">
                    <h4>ğŸï¸ Kurye Bilgileri</h4>
                    <p class="kurye-bekleniyor-text">Kurye atamasÄ± bekleniyor...</p>
                </div>
                {% endif %}

                {% if detaylar and detaylar|length > 0 %}
                <div class="info-section">
                    <h4>ğŸ½ï¸ SipariÅŸ DetaylarÄ±</h4>
                    <table class="siparis-detay-tablo">
                        <thead>
                            <tr>
                                <th>Yemek</th>
                                <th>Fiyat</th>
                                <th>Adet</th>
                                <th>Toplam</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for detay in detaylar %}
                            <tr>
                                <td>{{ detay[0] }}</td>
                                <td>{{ "%.2f"|format(detay[1]) }} â‚º</td>
                                <td>{{ detay[2] }}</td>
                                <td>{{ "%.2f"|format(detay[3]) }} â‚º</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="siparis-detay-toplam-label">
                                    <strong>Toplam:</strong>
                                </td>
                                <td class="siparis-detay-toplam-value">
                                    <strong>{{ "%.2f"|format(detaylar|sum(attribute=3)) }} â‚º</strong>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="siparis-empty-text">HenÃ¼z aktif sipariÅŸ yok.</p>
    {% endif %}
</div>
{% endblock %}