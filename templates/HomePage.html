{% extends "base.html" %}

{% block title %}Ana Sayfa · Tekne Ekmeği{% endblock %}

{% block content %}

<div class="card home-card">
    <h1>Yakındaki Restoranlar</h1>
    <p class="subtitle">Adresine en yakın restoranları listele ve sipariş ver.</p>

    <div class="restaurant-filter-row">
        <input type="text" id="filitre" name="filitre" class="restaurant-search-input"
            placeholder="Restoran adıyla filtrele...">
    </div>

    <div id="restaurant-list-wrapper">
        {% include "partials/restoran_list.html" %}
    </div>
</div>

<script>
    let filitreTimer = null;
    const filitreInput = document.getElementById('filitre');

    filitreInput.addEventListener('input', function (e) {
        const value = e.target.value;

        clearTimeout(filitreTimer);

        filitreTimer = setTimeout(function () {
            fetch('/restoranFiltre', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: JSON.stringify({ filitre: value })
            })
                .then(res => res.text())
                .then(html => {
                    document.getElementById('restaurant-list-wrapper').innerHTML = html;
                });
        }, 400);
    });
</script>

{% endblock %}